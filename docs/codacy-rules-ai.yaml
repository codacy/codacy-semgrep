rules:
  - id: codacy.csharp.ai.insecure-llm-model-usage
    languages:
      - csharp
    message: "Usage of Insecure LLM Model: $MODEL"
    severity: ERROR
    patterns:
      - pattern-either:
          - pattern: |
              $CLIENT.GenerateContentAsync(..., model: "$MODEL", ...)
          - pattern: |
              $CLIENT.GenerateContentAsync(model: "$MODEL", ...)
      - metavariable-regex:
          metavariable: $MODEL
          regex: "<!-- MODEL_REGEX -->"
    metadata:
      category: security
      subcategory: ai
      description: Detects usage of insecure LLM models in C# codebases to prevent potential
      technology:
        - csharp
      impact: MEDIUM
      confidence: MEDIUM
      likelihood: MEDIUM