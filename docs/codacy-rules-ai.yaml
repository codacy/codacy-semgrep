rules:
  - id: codacy.csharp.ai.insecure-llm-model-usage
    languages:
      - csharp
    message: "Usage of Insecure LLM Model: $MODEL"
    severity: ERROR
    patterns:
      - pattern-either:
          - pattern: |
              $CLIENT.GenerateContentAsync(..., model: "$MODEL", ...)
          - pattern: |
              $CLIENT.GenerateContentAsync(model: "$MODEL", ...)
      - metavariable-regex:
          metavariable: $MODEL
          # regex: "^(?!(gemini-2.5-flash|gpt-3.5-turbo|old-llama-model)$).*"
          regex: <!-- MODEL_ALLOW_LIST -->
    metadata:
      category: security
      subcategory: ai
      description: Detects usage of insecure/unauthorized LLM models in C# codebases
      technology:
        - csharp
      impact: MEDIUM
      confidence: LOW
      likelihood: MEDIUM